argo-workflows:
  server:
    baseHref: /argowf/
    sso:
      issuer: https://login.microsoftonline.com/f7619355-6c67-4100-9a78-1847f30742e2/v2.0
      redirectUrl: https://{{ .Values.ingress.hosts.main.host }}/argowf/oauth2/callback
  controller:
    workflowNamespaces:
      - tooling
      - argo-events

janus:
  enabled: true
  host: {{ .Values.ingress.hosts.main.host | quote }}
  certmanagerIssuer:
    name: {{ .Values.ingress.certmanagerissuer | quote }}
    kind: ClusterIssuer

  ingressRoutes:
    - name: argo-workflows
      entryPoints:
        - websecure
      routes:
        - kind: Rule
          match: PathPrefix(`/argowf`)
          services:
            - name: argo-workflows-server
              port: 2746
          middlewares:
            - name: argo-stripprefix
      certificate:
        enabled: true

  middlewares:
    - name: argo-stripprefix
      spec:
        stripPrefix:
          prefixes:
            - /argowf
